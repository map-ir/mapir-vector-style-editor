import o from"styled-components";import{__makeTemplateObject as t,__read as n,__assign as e}from"../../node_modules/tslib/tslib.es6.js";import i,{useState as r,useEffect as l,useMemo as a}from"react";import{useAtomValue as d,useSetAtom as m}from"jotai";import{usePopper as c}from"react-popper";import{FormattedMessage as u}from"react-intl";import s from"../../common/sample.js";import p from"../../common/portal.js";import f from"../../hooks/useOutsideClickHandler.js";import v from"../../common/utils/update-style.js";import{Row as h}from"../../common/styles.js";import{mapState as g,selectedLayerIDState as y,spriteState as b,styleObjState as x,layerState as j}from"../../atoms/map.js";var w,k=function(){var o,t,w,k,C,_=d(g),I=d(y),O=d(b),G=m(x),H=d(j),N=n(r(null),2),T=N[0],W=N[1],q=n(r(null),2),z=q[0],A=q[1],B=n(r(!1),2),D=B[0],F=B[1],J=n(r(),2),K=J[0],L=J[1],M=n(r(),2),P=M[0],Q=M[1],R=c(T,z,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,10]}}]}),S=R.styles,U=R.attributes;return l((function(){O&&fetch("".concat(O,".json"),{method:"GET"}).then((function(o){return o.json()})).then((function(o){return L(o)}))}),[O]),l((function(){var o,t;Q(null!==(t=null===(o=null==H?void 0:H.layout)||void 0===o?void 0:o["icon-image"])&&void 0!==t?t:"empty-e71566")}),[H]),f(a((function(){return{current:z}}),[z]),(function(o){(null==T?void 0:T.contains(o.target))||F(!1)})),i.createElement(h,null,i.createElement(u,{id:"symbol_type"}),P&&i.createElement(s,{title:P,ref:function(o){return W(o)},onClick:F.bind(null,!D),img:"".concat(O,".png"),x:null===(o=null==K?void 0:K[P])||void 0===o?void 0:o.x,y:null===(t=null==K?void 0:K[P])||void 0===t?void 0:t.y,width:null===(w=null==K?void 0:K[P])||void 0===w?void 0:w.width,height:null===(k=null==K?void 0:K[P])||void 0===k?void 0:k.height}),K&&D&&i.createElement(p,null,i.createElement(E,e({ref:function(o){A(o)},style:S.popper},U.popper),null===(C=Object.entries(K))||void 0===C?void 0:C.map((function(o){var t=n(o,2),e=t[0],r=t[1];return i.createElement(s,{key:e,img:"".concat(O,".png"),x:r.x,y:r.y,width:r.width,height:r.height,title:e,onClick:function(){I&&_&&v(I,_,"layout","icon-image","".concat(e),G)}})})))))},E=o.div.withConfig({displayName:"symbol-icon__IconWrapper",componentId:"sc-142xl73-0"})(w||(w=t(["\n  display: grid;\n  grid-template: auto / repeat(4, auto);\n  place-items: center;\n  gap: 1ch;\n  height: 10em;\n  background-color: var(--light-1);\n  border: 1px solid var(--shade-4);\n  border-radius: var(--radius-8);\n  padding: 0.5em;\n  box-shadow: 0 0 5px 0 var(--shade-4);\n  overflow: hidden;\n  overflow-y: auto;\n"],["\n  display: grid;\n  grid-template: auto / repeat(4, auto);\n  place-items: center;\n  gap: 1ch;\n  height: 10em;\n  background-color: var(--light-1);\n  border: 1px solid var(--shade-4);\n  border-radius: var(--radius-8);\n  padding: 0.5em;\n  box-shadow: 0 0 5px 0 var(--shade-4);\n  overflow: hidden;\n  overflow-y: auto;\n"])));export{k as default};
//# sourceMappingURL=symbol-icon.js.map
